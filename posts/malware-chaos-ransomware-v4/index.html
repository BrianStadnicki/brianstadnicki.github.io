<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title>Chaos ransomware v4 - Brian Stadnicki</title><meta name=Description content><meta property="og:title" content="Chaos ransomware v4">
<meta property="og:description" content="The chaos ransomware is fairly new, first appearing in June 2021 as a builder, offered on multiple darknet forums and marketplaces. It doesn&rsquo;t appear to have been involved in any significant incidents yet, a few minecraft players don&rsquo;t count. Unsurprisingly therefore, the sample has not had a single transaction to the wallet.
It isn&rsquo;t very complicated, as likely a simple proof-of-concept ransomware. Simply a 32bit .NET executable, with the ransom wallpaper base64 encoded in and completely unobfuscated with names.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://brianstadnicki.github.io/posts/malware-chaos-ransomware-v4/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-02-14T00:00:00+00:00">
<meta property="article:modified_time" content="2022-02-14T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Chaos ransomware v4">
<meta name=twitter:description content="The chaos ransomware is fairly new, first appearing in June 2021 as a builder, offered on multiple darknet forums and marketplaces. It doesn&rsquo;t appear to have been involved in any significant incidents yet, a few minecraft players don&rsquo;t count. Unsurprisingly therefore, the sample has not had a single transaction to the wallet.
It isn&rsquo;t very complicated, as likely a simple proof-of-concept ransomware. Simply a 32bit .NET executable, with the ransom wallpaper base64 encoded in and completely unobfuscated with names.">
<meta name=application-name content="Brian Stadnicki">
<meta name=apple-mobile-web-app-title content="Brian Stadnicki"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://brianstadnicki.github.io/posts/malware-chaos-ransomware-v4/><link rel=prev href=https://brianstadnicki.github.io/posts/malware-fantom-ransomware/><link rel=next href=https://brianstadnicki.github.io/posts/camera-jeemak-74r-firmware/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Chaos ransomware v4","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/brianstadnicki.github.io\/posts\/malware-chaos-ransomware-v4\/"},"genre":"posts","keywords":"reverse engineering, malware, ransomware, .NET, chaos","wordcount":618,"url":"https:\/\/brianstadnicki.github.io\/posts\/malware-chaos-ransomware-v4\/","datePublished":"2022-02-14T00:00:00+00:00","dateModified":"2022-02-14T00:00:00+00:00","publisher":{"@type":"Organization","name":"Brian Stadnicki"},"author":{"@type":"Person","name":"Brian Stadnicki"},"description":""}</script></head>
<body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':''==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:''==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="Brian Stadnicki">Brian Stadnicki</a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/> Posts </a><a class=menu-item href=/resume.pdf> Resume </a><a class=menu-item href=/tags/> Tags </a><a class=menu-item href=/categories/> Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a>
</div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="Brian Stadnicki">Brian Stadnicki</a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/resume.pdf title>Resume</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a></div>
</div>
</header>
<div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div>
<main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2>
<div class="toc-content always-active" id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animated flipInX">Chaos ransomware v4</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Brian Stadnicki</a></span>&nbsp;<span class=post-category>included in <a href=/categories/malware-analysis/><i class="far fa-folder fa-fw"></i>malware analysis</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-02-14>2022-02-14</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;618 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div>
</div><div class="details toc" id=toc-static kept>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#analysis>Analysis</a></li>
<li><a href=#ioc>IOC</a></li>
</ul>
</nav></div>
</div><div class=content id=content><p>The chaos ransomware is fairly new, first appearing in June 2021 as a builder, offered on multiple darknet forums and marketplaces. It doesn&rsquo;t appear to have been involved in any significant incidents yet, a <a href=https://www.nme.com/news/gaming-news/minecraft-stolen-account-list-is-actually-ransomware-that-attacks-cheaters-3085246 target=_blank rel="noopener noreffer">few minecraft players</a> don&rsquo;t count. Unsurprisingly therefore, the sample has not had a single transaction to the wallet.</p>
<p>It isn&rsquo;t very complicated, as likely a simple proof-of-concept ransomware. Simply a 32bit .NET executable, with the ransom wallpaper base64 encoded in and completely unobfuscated with names.</p>
<p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-chaos-ransomware-v4/screenshot.png data-srcset="/posts/malware-chaos-ransomware-v4/screenshot.png, /posts/malware-chaos-ransomware-v4/screenshot.png 1.5x, /posts/malware-chaos-ransomware-v4/screenshot.png 2x" data-sizes=auto alt=/posts/malware-chaos-ransomware-v4/screenshot.png title=/posts/malware-chaos-ransomware-v4/screenshot.png></p>
<h2 id=analysis>Analysis</h2>
<p>The execution process is as follows:</p>
<ul>
<li>Make sure only copy running</li>
<li>If not running from the temp folder, wait 10 seconds (anti-virus evasion)</li>
<li>If not running as admin, copy itself to the roaming folder and run</li>
<li>Add itself to the startup folder</li>
<li>Delete itself, copy itself to the roaming folder and run</li>
<li>Look for directories to encrypt (drives other than C:\ and common user directories)</li>
<li>Recursively encrypt the files with the correct file extension and add a random file extension
<ul>
<li>2.2mb are AES encrypted</li>
<li>Over 200mb are partly overwritten with random bytes</li>
<li>Inbetween are randomly overwritten</li>
<li>Write a ransom note read_it.txt to the directory</li>
</ul>
</li>
<li>If running as admin
<ul>
<li>Delete backups</li>
<li>Disable recovery modes</li>
<li>Delete backup catalog (record of where backups are)</li>
</ul>
</li>
<li>Spread to external drives by copying itself to drives which aren&rsquo;t C:\</li>
<li>Drop the ransom message and open in notepad</li>
<li>Set the wallpaper</li>
<li>Change any bitcoin addresses in the clipboard</li>
</ul>
<h2 id=ioc>IOC</h2>
<p>Sample: d9771a04128e50870a96bc7ac8605982205011b723810a04a3411a1ac7eba05d</p>
<p>Names:</p>
<ul>
<li>surprise.exe</li>
<li>svchost.exe</li>
<li>read_it.txt</li>
</ul>
<p>Ransom message:</p>
<pre tabindex=0><code>First of all, sorry. It's just business. 

All your files have been encrypted. All your documents are unavailable. 

The encryption was done using a secret key designed by our company.

In order to decrypt your files you must buy an exclusive key from us.

Do not reset or shutdown - files may be damaged.
Do not rename or move encrypted files - they may be lost forever.
Do not try to delete readme files - files may be damaged.

Please send $150k in Bitcoin to the following wallet: bc1qp94vpfjgm6z7fvcsa43cymjpyytweqjju9u7dp

If you do not own Bitcoin yet, we suggest a quick Google search. 

After 24 hours the payment will double. After 48 hours files will be deleted. 

If you have a proposal within 2 hours you will get a discount, minimizing this tragic event so you can get back to work.

Please contact us via email: sorryitsjustbusiness@protonmail.com

</code></pre><p>File extensions infected:</p>
<p>.txt, .jar, .dat, .contact, .settings, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .odt, .jpg, .mka, .mhtml, .oqy, .png, .csv, .py, .sql, .mdb, .php, .asp, .aspx, .html, .htm, .xml, .psd, .pdf, .xla, .cub, .dae, .indd, .cs, .mp3, .mp4, .dwg, .zip, .rar, .mov, .rtf, .bmp, .mkv, .avi, .apk, .lnk, .dib, .dic, .dif, .divx, .iso, .7zip, .ace, .arj, .bz2, .cab, .gzip, .lzh, .tar, .jpeg, .xz, .mpeg, .torrent, .mpg, .core, .pdb, .ico, .pas, .db, .wmv, .swf, .cer, .bak, .backup, .accdb, .bay, .p7c, .exif, .vss, .raw, .m4a, .wma, .flv, .sie, .sum, .ibank, .wallet, .css, .js, .rb, .crt, .xlsm, .xlsb, .7z, .cpp, .java, .jpe, .ini, .blob, .wps, .docm, .wav, .3gp, .webm, .m4v, .amv, .m4p, .svg, .ods, .bk, .vdi, .vmdk, .onepkg, .accde, .jsp, .json, .gif, .log, .gz, .config, .vb, .m1v, .sln, .pst, .obj, .xlam, .djvu, .inc, .cvs, .dbf, .tbi, .wpd, .dot, .dotx, .xltx, .pptm, .potx, .potm, .pot, .xlw, .xps, .xsd, .xsf, .xsl, .kmz, .accdr, .stm, .accdt, .ppam, .pps, .ppsm, .1cd, .3ds, .3fr, .3g2, .accda, .accdc, .accdw, .adp, .ai, .ai3, .ai4, .ai5, .ai6, .ai7, .ai8, .arw, .ascx, .asm, .asmx, .avs, .bin, .cfm, .dbx, .dcm, .dcr, .pict, .rgbe, .dwt, .f4v, .exr, .kwm, .max, .mda, .mde, .mdf, .mdw, .mht, .mpv, .msg, .myi, .nef, .odc, .geo, .swift, .odm, .odp, .oft, .orf, .pfx, .p12, .pl, .pls, .safe, .tab, .vbs, .xlk, .xlm, .xlt, .xltm, .svgz, .slk, .tar.gz, .dmg, .ps, .psb, .tif, .rss, .key, .vob, .epsp, .dc3, .iff, .onepkg, .onetoc2, .opt, .p7b, .pam, .r3d</p>
</div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2022-02-14</span>
</div>
<div class=post-info-license></div>
</div>
<div class=post-info-line>
<div class=post-info-md></div>
<div class=post-info-share>
<span></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/reverse-engineering/>reverse engineering</a>,&nbsp;<a href=/tags/malware/>malware</a>,&nbsp;<a href=/tags/ransomware/>ransomware</a>,&nbsp;<a href=/tags/.net/>.NET</a>,&nbsp;<a href=/tags/chaos/>chaos</a></section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section>
</div>
<div class=post-nav><a href=/posts/malware-fantom-ransomware/ class=prev rel=prev title="Fantom ransomware"><i class="fas fa-angle-left fa-fw"></i>Fantom ransomware</a>
<a href=/posts/camera-jeemak-74r-firmware/ class=next rel=next title="Jeemak 74R camera simple firmware extraction">Jeemak 74R camera simple firmware extraction<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.92.2">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
</div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw"></i>
</a>
</div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "f5dd1cc794e748f0a1fa431f62434694"}'></script></body>
</html>