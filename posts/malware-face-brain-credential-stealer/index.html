<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title>Face Brain: Password stealer with vm detection - Brian Stadnicki</title><meta name=Description content><meta property="og:title" content="Face Brain: Password stealer with vm detection">
<meta property="og:description" content="Today I&rsquo;m taking a look at a password stealer filled with obfuscation and some virtual machine detection. The sample can be obtained from malshare, with an automated analysis report on joesandbox.
   Property Value     File Type Portable Executable 64   File Size 3.69 MB   CompanyName Say celebrate Date   FileDescription Dress Suffer fuel basic   FileVersion 6.4.14.15   LegalCopyright Pine Shit (c) 2005   ProductName Almost publication   MD5 3c7c6d236721ea4cef0f904ebde6f575   SHA1 d82cd631a49a175caace0fb209f7b9da16e29655   SHA256 ed107d31ac4a6e8f665986e3326cc2c4551fd00ba26f5414faa8edd0f7c20061    Initial overview The sandbox report provides us with a lot of useful initial information.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://brianstadnicki.github.io/posts/malware-face-brain-credential-stealer/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-12-21T00:00:00+00:00">
<meta property="article:modified_time" content="2021-12-21T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Face Brain: Password stealer with vm detection">
<meta name=twitter:description content="Today I&rsquo;m taking a look at a password stealer filled with obfuscation and some virtual machine detection. The sample can be obtained from malshare, with an automated analysis report on joesandbox.
   Property Value     File Type Portable Executable 64   File Size 3.69 MB   CompanyName Say celebrate Date   FileDescription Dress Suffer fuel basic   FileVersion 6.4.14.15   LegalCopyright Pine Shit (c) 2005   ProductName Almost publication   MD5 3c7c6d236721ea4cef0f904ebde6f575   SHA1 d82cd631a49a175caace0fb209f7b9da16e29655   SHA256 ed107d31ac4a6e8f665986e3326cc2c4551fd00ba26f5414faa8edd0f7c20061    Initial overview The sandbox report provides us with a lot of useful initial information.">
<meta name=application-name content="Brian Stadnicki">
<meta name=apple-mobile-web-app-title content="Brian Stadnicki"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://brianstadnicki.github.io/posts/malware-face-brain-credential-stealer/><link rel=prev href=https://brianstadnicki.github.io/posts/asm-self-modifying-factorial/><link rel=next href=https://brianstadnicki.github.io/posts/malware-sbidiot-dec2021/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Face Brain: Password stealer with vm detection","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/brianstadnicki.github.io\/posts\/malware-face-brain-credential-stealer\/"},"genre":"posts","keywords":"reverse engineering, malware, stealer, anti-vm","wordcount":460,"url":"https:\/\/brianstadnicki.github.io\/posts\/malware-face-brain-credential-stealer\/","datePublished":"2021-12-21T00:00:00+00:00","dateModified":"2021-12-21T00:00:00+00:00","publisher":{"@type":"Organization","name":"Brian Stadnicki"},"author":{"@type":"Person","name":"Brian Stadnicki"},"description":""}</script></head><body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":''==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:''==="dark")&&document.body.setAttribute("theme","dark")</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="Brian Stadnicki">Brian Stadnicki</a>
</div><div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/> Posts </a><a class=menu-item href=/resume.pdf> Resume </a><a class=menu-item href=/tags/> Tags </a><a class=menu-item href=/categories/> Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a>
</div></div></div></header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="Brian Stadnicki">Brian Stadnicki</a>
</div><div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/resume.pdf title>Resume</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a></div></div></header><div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div></div><main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Face Brain: Password stealer with vm detection</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Brian Stadnicki</a></span>&nbsp;<span class=post-category>included in <a href=/categories/malware-analysis/><i class="far fa-folder fa-fw"></i>malware analysis</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-12-21>2021-12-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;460 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span>
</div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#initial-overview>Initial overview</a></li><li><a href=#junk-data>Junk data</a></li><li><a href=#initial-run>Initial run</a>
<ul>
<li><a href=#work-around>Work around</a></li></ul></li><li><a href=#continued-run>Continued run</a>
<ul>
<li><a href=#data-collected>Data collected</a></li><li><a href=#calling-home>Calling home</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><div class=content id=content><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/malware-icon.png data-srcset="/posts/malware-face-brain-credential-stealer/malware-icon.png, /posts/malware-face-brain-credential-stealer/malware-icon.png 1.5x, /posts/malware-face-brain-credential-stealer/malware-icon.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/malware-icon.png title=Icon></p><p>Today I&rsquo;m taking a look at a password stealer filled with obfuscation and some virtual machine detection. The sample can be obtained from <a href="https://malshare.com/sample.php?action=detail&hash=ed107d31ac4a6e8f665986e3326cc2c4551fd00ba26f5414faa8edd0f7c20061" target=_blank rel="noopener noreffer">malshare</a>, with an automated analysis report on <a href=https://www.joesandbox.com/analysis/542989/0/html target=_blank rel="noopener noreffer">joesandbox</a>.</p><table>
<thead>
<tr>
<th>Property</th><th>Value</th></tr></thead><tbody>
<tr>
<td>File Type</td><td>Portable Executable 64</td></tr><tr>
<td>File Size</td><td>3.69 MB</td></tr><tr>
<td>CompanyName</td><td>Say celebrate Date</td></tr><tr>
<td>FileDescription</td><td>Dress Suffer fuel basic</td></tr><tr>
<td>FileVersion</td><td>6.4.14.15</td></tr><tr>
<td>LegalCopyright</td><td>Pine Shit (c) 2005</td></tr><tr>
<td>ProductName</td><td>Almost publication</td></tr><tr>
<td>MD5</td><td>3c7c6d236721ea4cef0f904ebde6f575</td></tr><tr>
<td>SHA1</td><td>d82cd631a49a175caace0fb209f7b9da16e29655</td></tr><tr>
<td>SHA256</td><td>ed107d31ac4a6e8f665986e3326cc2c4551fd00ba26f5414faa8edd0f7c20061</td></tr></tbody></table><h2 id=initial-overview>Initial overview</h2><p>The sandbox report provides us with a lot of useful initial information. It tells us that it&rsquo;s attempting to steal credentials, and contains anti-analysis techniques such as dummy data, code obfuscation and cpuid.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/joesandbox-signatures.png data-srcset="/posts/malware-face-brain-credential-stealer/joesandbox-signatures.png, /posts/malware-face-brain-credential-stealer/joesandbox-signatures.png 1.5x, /posts/malware-face-brain-credential-stealer/joesandbox-signatures.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/joesandbox-signatures.png title=Signatures></p><h2 id=junk-data>Junk data</h2><p>There are several techniques used in this sample to evade analysis. For example, there&rsquo;s a lot of dummy base64 strings to annoy me a bit.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/dummy-b64-strings.png data-srcset="/posts/malware-face-brain-credential-stealer/dummy-b64-strings.png, /posts/malware-face-brain-credential-stealer/dummy-b64-strings.png 1.5x, /posts/malware-face-brain-credential-stealer/dummy-b64-strings.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/dummy-b64-strings.png title="Dummy base64 strings"></p><p>Among them is the string I used for naming this sample, since it doesn&rsquo;t appear to have a classification.</p><p>There&rsquo;s also a lot of general dummy strings.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/dummy-text-strings.png data-srcset="/posts/malware-face-brain-credential-stealer/dummy-text-strings.png, /posts/malware-face-brain-credential-stealer/dummy-text-strings.png 1.5x, /posts/malware-face-brain-credential-stealer/dummy-text-strings.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/dummy-text-strings.png title="General dummy strings"></p><h2 id=initial-run>Initial run</h2><p>When I initially ran this, I observed a high CPU usage, probably from whatever it&rsquo;s doing after loading some crypto libraries, followed by the process exiting. That&rsquo;s not my expectation.</p><h3 id=work-around>Work around</h3><p>The sandbox signatures mentioned <code>Contains functionality to query CPU information (cpuid)</code>.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/mentions-cpuid.png data-srcset="/posts/malware-face-brain-credential-stealer/mentions-cpuid.png, /posts/malware-face-brain-credential-stealer/mentions-cpuid.png 1.5x, /posts/malware-face-brain-credential-stealer/mentions-cpuid.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/mentions-cpuid.png title="204 mentions of cpuid"></p><p>There&rsquo;s 204 mentions of <code>cpuid</code>, because this sample is quite heavily obfuscated.</p><p>To defeat this anti-vm technique, there&rsquo;s a great post on <a href=https://rayanfam.com/topics/defeating-malware-anti-vm-techniques-cpuid-based-instructions/ target=_blank rel="noopener noreffer">Sina & Shahria&rsquo;s Blog</a> about it.</p><p>I don&rsquo;t know which registers are being used for this detection, so I&rsquo;ll write over them all:</p><pre tabindex=0><code>cpuid.1.rax=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.rbx=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.rcx=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.rdx=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.rex=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.r8=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.r9=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.r10=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.r11=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.r12=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.r13=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.r14=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.r15=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
cpuid.1.r16=&#34;0---:----:----:----:----:----:----:----:----:----:----:----:----:----:----:----&#34;
</code></pre><p>I append this to my vmware virtual machine&rsquo;s .vmx file.</p><h2 id=continued-run>Continued run</h2><p>Now that the anti-vm detection has been defeated, I can focus on the stealing part itself.</p><p>The code is heavily obfuscated, complete spaghetti, so I&rsquo;m not going to bother with a lot of static analysis, simply what&rsquo;s going on in procmon.</p><h3 id=data-collected>Data collected</h3><table>
<thead>
<tr>
<th>Data</th><th>Evidence</th></tr></thead><tbody>
<tr>
<td>Computer Name</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-computer-name.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-computer-name.png, /posts/malware-face-brain-credential-stealer/evidence-computer-name.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-computer-name.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-computer-name.png title=/posts/malware-face-brain-credential-stealer/evidence-computer-name.png></td></tr><tr>
<td>WinSCP sessions</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-winscp-sessions.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-winscp-sessions.png, /posts/malware-face-brain-credential-stealer/evidence-winscp-sessions.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-winscp-sessions.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-winscp-sessions.png title=/posts/malware-face-brain-credential-stealer/evidence-winscp-sessions.png></td></tr><tr>
<td>FileZilla credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-filezilla-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-filezilla-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-filezilla-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-filezilla-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-filezilla-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-filezilla-credentials.png></td></tr><tr>
<td>Firefox credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-firefox-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-firefox-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-firefox-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-firefox-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-firefox-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-firefox-credentials.png></td></tr><tr>
<td>Microsoft Edge credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-microsoft-edge-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-microsoft-edge-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-microsoft-edge-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-microsoft-edge-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-microsoft-edge-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-microsoft-edge-credentials.png></td></tr><tr>
<td>Yandex browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-yandex-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-yandex-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-yandex-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-yandex-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-yandex-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-yandex-browser-credentials.png></td></tr><tr>
<td>Brave browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-brave-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-brave-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-brave-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-brave-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-brave-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-brave-browser-credentials.png></td></tr><tr>
<td>Opera credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-opera-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-opera-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-opera-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-opera-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-opera-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-opera-browser-credentials.png></td></tr><tr>
<td>Google Chrome credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-google-chrome-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-google-chrome-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-google-chrome-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-google-chrome-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-google-chrome-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-google-chrome-credentials.png></td></tr><tr>
<td>7 Star browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-7-star-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-7-star-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-7-star-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-7-star-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-7-star-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-7-star-browser-credentials.png></td></tr><tr>
<td>Amigo browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-amigo-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-amigo-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-amigo-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-amigo-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-amigo-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-amigo-browser-credentials.png></td></tr><tr>
<td>Cent browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-cent-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-cent-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-cent-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-cent-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-cent-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-cent-browser-credentials.png></td></tr><tr>
<td>Chedot browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-chedot-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-chedot-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-chedot-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-chedot-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-chedot-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-chedot-browser-credentials.png></td></tr><tr>
<td>Google chrome SxS credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-google-chrome-sxs-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-google-chrome-sxs-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-google-chrome-sxs-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-google-chrome-sxs-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-google-chrome-sxs-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-google-chrome-sxs-credentials.png></td></tr><tr>
<td>Chromium credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-chromium-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-chromium-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-chromium-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-chromium-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-chromium-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-chromium-credentials.png></td></tr><tr>
<td>CocCoc browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-coccoc-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-coccoc-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-coccoc-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-coccoc-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-coccoc-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-coccoc-browser-credentials.png></td></tr><tr>
<td>Comodo browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-comodo-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-comodo-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-comodo-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-comodo-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-comodo-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-comodo-credentials.png></td></tr><tr>
<td>Elements browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-elements-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-elements-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-elements-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-elements-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-elements-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-elements-browser-credentials.png></td></tr><tr>
<td>Epic Privacy browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-epic-privacy-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-epic-privacy-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-epic-privacy-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-epic-privacy-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-epic-privacy-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-epic-privacy-browser-credentials.png></td></tr><tr>
<td>Kometa browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-kometa-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-kometa-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-kometa-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-kometa-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-kometa-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-kometa-browser-credentials.png></td></tr><tr>
<td>Orbitum browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-orbitum-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-orbitum-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-orbitum-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-orbitum-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-orbitum-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-orbitum-browser-credentials.png></td></tr><tr>
<td>Sputnik browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-sputnik-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-sputnik-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-sputnik-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-sputnik-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-sputnik-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-sputnik-browser-credentials.png></td></tr><tr>
<td>Torch browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-torch-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-torch-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-torch-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-torch-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-torch-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-torch-browser-credentials.png></td></tr><tr>
<td>Ucoz Media Uran browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-ucoz-media-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-ucoz-media-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-ucoz-media-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-ucoz-media-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-ucoz-media-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-ucoz-media-browser-credentials.png></td></tr><tr>
<td>Vivaldi browser credentials</td><td><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/evidence-vivaldi-browser-credentials.png data-srcset="/posts/malware-face-brain-credential-stealer/evidence-vivaldi-browser-credentials.png, /posts/malware-face-brain-credential-stealer/evidence-vivaldi-browser-credentials.png 1.5x, /posts/malware-face-brain-credential-stealer/evidence-vivaldi-browser-credentials.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/evidence-vivaldi-browser-credentials.png title=/posts/malware-face-brain-credential-stealer/evidence-vivaldi-browser-credentials.png></td></tr></tbody></table><h3 id=calling-home>Calling home</h3><p>Once all the credentials are collected, it sends it back to a server from a Lithuanian hosting provider that is a <a href=https://cleantalk.org/blacklists/as61272 target=_blank rel="noopener noreffer">known spam hoster</a>.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/malware-face-brain-credential-stealer/call-home.png data-srcset="/posts/malware-face-brain-credential-stealer/call-home.png, /posts/malware-face-brain-credential-stealer/call-home.png 1.5x, /posts/malware-face-brain-credential-stealer/call-home.png 2x" data-sizes=auto alt=/posts/malware-face-brain-credential-stealer/call-home.png title="Calls home"></p><h2 id=conclusion>Conclusion</h2><p>This is a fairly comphrensive stealer in terms of browsers, and it&rsquo;s certainly very well obfuscated. However, it doesn&rsquo;t detect its environment well. The anti-vm can be easily defeated, and it doesn&rsquo;t even check for debuggers, nor analysis tools such as procmon.</p></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2021-12-21</span>
</div><div class=post-info-license></div></div><div class=post-info-line>
<div class=post-info-md></div><div class=post-info-share>
<span></span>
</div></div></div><div class=post-info-more>
<section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/reverse-engineering/>reverse engineering</a>,&nbsp;<a href=/tags/malware/>malware</a>,&nbsp;<a href=/tags/stealer/>stealer</a>,&nbsp;<a href=/tags/anti-vm/>anti-vm</a></section><section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section></div><div class=post-nav><a href=/posts/asm-self-modifying-factorial/ class=prev rel=prev title="Writing a self-modifying x86 factorial program"><i class="fas fa-angle-left fa-fw"></i>Writing a self-modifying x86 factorial program</a>
<a href=/posts/malware-sbidiot-dec2021/ class=next rel=next title="SBIDIOT IoT Malware: miner edition">SBIDIOT IoT Malware: miner edition<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer>
<div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.93.2">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
</div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw"></i>
</a>
</div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "f5dd1cc794e748f0a1fa431f62434694"}'></script></body></html>