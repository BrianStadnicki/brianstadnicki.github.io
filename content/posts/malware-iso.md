+++
author = "Brian Stadnicki"
title = "Phishing with malicious iso files"
date = "2022-03-25"
categories = [ "malware analysis" ]
tags = [ "reverse engineering", "malware", "iso", "phishing", "remcos" ]
+++

Phishing emails rely on many methods, such as sending exploit documents or executables. Thankfully, companies have figured out that this is common and implemented file attachment extension blockers, such as preventing external .pdf files and all .exe files.

![Example from ACSC](/posts/malware-iso/covid-19-relief-payment-scam.png)

Above is an example from the [ACSC](https://www.cyber.gov.au/acsc/view-all-content/advisories/covid-19-malicious-scams-threat-awareness-and-guidance).

## Bypass

So how do you bypass this? Commonly you add a link or some javascript, but what if you just put your file inside of a container, such as zip or rar?

Phishing training does now cover this, but what about an iso?

[cocaman](https://bazaar.abuse.ch/user/1169961/) reported one of these phishing emails on malware bazaar, with an [Attachment.iso](https://bazaar.abuse.ch/sample/d01d468b1a708cdd63e86e00990dcb996eca66807175975fd139a3da4ec4b038/) attachment.

```
From: "<<Canada Post Delivery>> canadapost@mailingconfirm.com" (likely spoofed)
Received: "from compassionate-mahavira.206-221-176-154.plesk.page (mail.mail-server-desk.com [206.221.176.154]) "
Date: "Fri, 25 Mar 2022 12:48:40 +0000"
Subject: "Delivery Updated"
Attachment: "Attachment.iso"
```

![](/posts/malware-iso/attachment-first.png)

Windows makes it very easy to interact with .iso files, double clicking automatically makes it mount and show the disk image.

![](/posts/malware-iso/attachment-second.png)

Hopefully the target at this point would notice that it is a .exe, but the classic word icon may fool them.

This specific sample leads to a [DBatLoader](https://malpedia.caad.fkie.fraunhofer.de/details/win.dbatloader) dropping [Remcos RAT](https://malpedia.caad.fkie.fraunhofer.de/details/win.remcos). Triage has already created a config extractor for the remcos client and created a [report](https://tria.ge/220325-q1wh7sdecm).

This writeup hasn't been technical, but it needs to be recognised that simple methods can bypass email safety rules, and users need to be trained for this rather than putting up minimal safety nets.
